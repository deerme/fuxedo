#!/usr/bin/env python

import sys

base = 0

fin = open(sys.argv[-1], 'r')

types = {
    'short': 0,
    'long': 1,
    'char': 2,
    'float': 3,
    'double': 4,
    'string': 5,
    'carray': 6,
    'ptr': 9,
    'fml32': 10,
    'view32': 11,
    'mbstring': 12,
    'fml': 13,
}

for line in fin.readlines():
    parts = line.split()

    if len(parts) < 2 or parts[0].startswith('#') or parts[0].startswith('$'):
        continue

    if parts[0] == '*base':
        base = int(parts[1])
    elif len(parts) > 2:
        fieldno = int(parts[1]) + base
        fieldid = fieldno << 8 + types[parts[2]]
        print '#define %s ((FLDID32)%d) /* number: %d type: %s */' % (parts[0], fieldid, fieldno, parts[2])
